###
##    Write a Python script using CadQuery to create a cylinder with a hollow semicircle attached to resemble a parametric mug. The script should:
##        - Create a base cylinder of diameter 5 inches and height 6 inches
##        - Ensure that the cylinder is a tube with a wall thickness of 0.3 inches and hollow in the center
##        - Generate a base plate of 1/2 inch thickness and of same diameter as the cylinder should be attached to the base of the cylinder
##        - Generate a hollow semicircle that that is 3 inches in radius and 1 inch thick. 
##        - Ensure that the halfline of the semicircle is connected to the cylinder's surface smoothly at two points and centered vertically along the cylinder's height.
##        - Include proper imports and documentation
##        - Ensure the final object is a valid solid
##
##    
import cadquery as cq

# Parameters (in inches)
cyl_diam        = 5.0         # Outer diameter of the cylinder
cyl_height      = 6.0         # Height of the cylinder (tube part)
wall_thickness  = 0.3         # Cylinder wall thickness
base_thickness  = 0.5         # Base plate thickness
cyl_outer_rad   = cyl_diam/2.0
cyl_inner_rad   = cyl_outer_rad - wall_thickness

# Handle parameters
handle_mid_radius = 3.0      # Handle mid (outer) semicircle radius (from its center)
handle_thickness  = 1.0      # Thickness of the handle wall (difference between outer and inner arcs)
# In our construction the inner arc will have a radius = handle_mid_radius - handle_thickness = 2.0.
# We want the handle to attach smoothly to the cylinder so that its inner face coincides with
# the cylinder's outer surface (x = cyl_outer_rad). To achieve that we will later translate the handle by -0.5 in X.
# The handle will be centered vertically on the cylinder (cylinder base at z = base_thickness,
# cylinder top at z = base_thickness + cyl_height, so center is at z = base_thickness + cyl_height/2).

# Create the base plate (a disc of same diameter as the cylinder)
base_plate = cq.Workplane("XY").circle(cyl_outer_rad).extrude(base_thickness)

# Create the cylindrical tube (mug body)
# The outer cylinder is created on a workplane at z = base_thickness to position it atop the base plate.
outer_cyl = cq.Workplane("XY").workplane(offset=base_thickness).circle(cyl_outer_rad).extrude(cyl_height)
inner_cyl = cq.Workplane("XY").workplane(offset=base_thickness).circle(cyl_inner_rad).extrude(cyl_height)
tube = outer_cyl.cut(inner_cyl)

mug_body = base_plate.union(tube)

# Create the handle as a hollow semicircular ring.
# We build its 2D profile in the XZ plane and then extrude it in the Y direction.
# The profile is defined as follows:
#   - Outer arc: a semicircular arc of radius 3 inches centered at (3,0) in the XZ plane,
#       going from point (3, 3) to (3, -3). (This is generated by a threePointArc via (6, 0).)
#   - A straight line from (3, -3) to (3, -2) (transition to the inner arc).
#   - Inner arc: a semicircular arc of radius 2 inches (3 - 1) centered at (3,0),
#       going from (3, -2) to (3, 2) generated by a threePointArc via (5, 0).
#   - A straight line from (3, 2) back to the starting point (3, 3).
#
# After extrusion, the handle is shifted so that its inner face (initially at x = 3)
# translates by -0.5 in X, giving x = 2.5 which matches the mug's outer surface.
# Finally, the handle is translated vertically to be centered on the mug.
handle_profile = (cq.Workplane("XZ")
    .moveTo(3, 3)
    .threePointArc((6, 0), (3, -3))
    .lineTo(3, -2)
    .threePointArc((5, 0), (3, 2))
    .close()
)

# Extrude the 2D handle profile in the Y direction to a thickness of 1 inch
handle_solid = handle_profile.extrude(handle_thickness)

# Translate the handle so that:
#   - Its inner edge (originally at x = 3) shifts to x = 2.5 (i.e. -0.5 shift in X),
#   - It is centered vertically on the mug. The cylinder extends from z = base_thickness
#     to z = base_thickness + cyl_height so its center is at z = base_thickness + cyl_height/2.
handle_position = ( -0.5, 0, base_thickness + cyl_height/2 )
handle_solid = handle_solid.translate(handle_position)

# Combine the mug body and the handle
mug = mug_body.union(handle_solid)

# Display the final mug object # If running in a CadQuery-enabled environment
display(mug)      # As requested, use display() to show the final object
